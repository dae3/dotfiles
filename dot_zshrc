typeset -U path cdpath fpath manpath
bindkey -e

if ! [[ "$PATH" =~ "$HOME/.local/bin:$HOME/bin:" ]]
then
    PATH="$HOME/.local/bin:$HOME/bin:$PATH"
fi

if [ -x /usr/local/go/bin/go ]; then
  PATH="$PATH:/usr/local/go/bin"
fi

# setup completions for things that might live in ~/.local/bin or ~/bin
COMPLETIONS=(chezmoi gh)
LOCALCOMP=${HOME}/.config/completion
fpath+=${LOCALCOMP}
if [ ! -d ${LOCALCOMP} ]; then
  mkdir -p ${LOCALCOMP}
  for c in ${COMPLETIONS}; do
    which $c > /dev/null 2&>1
    if [ $? -eq 0 ]; then
      $c completion zsh > ${LOCALCOMP}/_$c
    fi
  done
fi

autoload -U compinit && compinit

# aws cli completion nonsense
# https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-completion.html#cli-command-completion-linux]
if [[ -x /usr/local/bin/aws && -x /usr/local/bin/aws_completer ]]; then
  autoload bashcompinit && bashcompinit
  complete -C '/usr/local/bin/aws_completer' aws
fi

setopt autocd

THEME=bubblesextra.omp.json
which oh-my-posh > /dev/null 2>&1
if [[ $? -eq 0 && -f ~/.config/${THEME} ]]; then
  eval "$(oh-my-posh init zsh --config ~/.config/${THEME})"
fi

if [ -d /home/linuxbrew ]; then
  eval "$(/home/linuxbrew/.linuxbrew/bin/brew shellenv)"
fi

which direnv > /dev/null
if [ $? -eq 0 ]; then
  eval "$(direnv hook zsh)"
fi

hash -d acl="$HOME/ACloud"
hash -d labs="$HOME/labs"
hash -d projects="$HOME/projects"

# toolbox container name
if [ -f /run/.containerenv ]; then
  export TOOLBOXNAME=$(awk -F'"' '/^name/ { print $2 }' /run/.containerenv)
fi

# vim: ft=zsh ff=unix sw=2 ts=2 ai et
